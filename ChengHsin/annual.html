<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å°¾ç‰™å°éŠæˆ²</title>
    <style>
        :root {
            --bg: #121212;
            --card: #1e1e1e;
            --text: #e0e0e0;
            --gold: #ffd700;
            --red: #ff4757;
            --green: #2ed573;
            --blue: #3742fa;
        }
        body { font-family: -apple-system, "Microsoft JhengHei", sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0 10px 10px 10px; user-select: none; -webkit-tap-highlight-color: transparent; padding-bottom: 50px; }
        .navbar {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 12px 15px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        /* 1. å…¨å±€è¨ˆæ™‚å™¨ (Sticky Header) */
        #global-header {
            position: sticky; top: 0; z-index: 999;
            background: #000; border-bottom: 2px solid var(--gold);
            padding: 10px 5px; margin: 0 -10px 15px -10px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.8);
        }
        .g-info { display: flex; flex-direction: column; }
        .g-label { font-size: 0.7rem; color: #888; letter-spacing: 1px; }
        #g-timer { font-family: 'Courier New', monospace; font-size: 1.8rem; font-weight: bold; color: var(--gold); line-height: 1; }
        #g-btn { background: var(--green); color: #000; border: none; padding: 8px 15px; border-radius: 5px; font-weight: bold; font-size: 0.9rem; }

        /* 2. ç©åˆ†å€ */
        .score-box { background: var(--card); padding: 10px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #333; }
        .score-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        .p-card { background: #2c2c2c; padding: 5px; border-radius: 6px; text-align: center; border: 1px solid #444; }
        .p-info { display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; color: #aaa; padding: 0 5px; }
        .p-val { font-size: 1.3rem; font-weight: bold; color: var(--gold); margin: 2px 0; }
        .btn-score { width: 100%; border: none; padding: 4px; font-size: 1rem; color: white; border-radius: 4px; cursor: pointer; }
        
        /* 3. é¡Œç›®å€ */
        .q-card { background: var(--card); margin-bottom: 12px; padding: 12px; border-radius: 10px; border-left: 4px solid #555; transition: 0.3s; }
        .q-card.active { border-left-color: var(--gold); background: #252525; box-shadow: 0 0 15px rgba(255, 215, 0, 0.1); }
        
        .q-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .q-title { font-weight: bold; font-size: 1rem; color: #fff; }
        .q-timer { font-family: 'Courier New', monospace; font-size: 1.4rem; font-weight: bold; color: #666; }
        .active .q-timer { color: var(--red); }

        .btn-ctrl { width: 100%; padding: 12px; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; margin-bottom: 8px; background: #444; color: #aaa; }
        .active .btn-ctrl { background: var(--blue); color: white; }

        /* æç¤ºæŒ‰éˆ•èˆ‡å…§å®¹ */
        .hint-btn { width: 100%; padding: 10px; background: transparent; border: 1px dashed #666; color: #888; border-radius: 6px; text-align: left; font-size: 0.9rem; position: relative; }
        .hint-content { display: none; margin-top: 8px; background: #2a2a2a; padding: 8px; border-radius: 6px; }
        .h-row { font-size: 0.85rem; padding: 6px 0; border-bottom: 1px solid #333; line-height: 1.4; color: #ccc; }
        .h-row b { color: var(--gold); margin-right: 5px; font-size: 0.75rem; background: rgba(255,215,0,0.15); padding: 2px 5px; border-radius: 3px; }

        /* å‹•ç•«ç‰¹æ•ˆ */
        @keyframes pulse-yellow { 0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); border-color: var(--gold); color: var(--gold); } 70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); } }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7); border-color: var(--red); color: var(--red); } 70% { box-shadow: 0 0 0 10px rgba(255, 71, 87, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0); } }
        
        .alert-yellow { animation: pulse-yellow 1.5s infinite; }
        .alert-red { animation: pulse-red 1s infinite; }
        
        /* ç‹€æ…‹æ¢ */
        .status-bar { height: 4px; background: #333; width: 100%; border-radius: 2px; margin-top: 5px; overflow: hidden; }
        .progress { height: 100%; background: var(--green); width: 100%; transition: width 1s linear; }
    </style>
</head>
<body>
 <nav class="navbar">
        <a href="../NavBar.html" class="back-btn">
            <i class="fas fa-chevron-left"></i>
            <span style="font-size: 0.9rem; margin-left: 5px; font-weight: bold;">ç›®éŒ„</span>
        </a>
    </nav>
    <div id="global-header">
        <div class="g-info">
            <span class="g-label">TOTAL (30 MIN)</span>
            <div id="g-timer">30:00</div>
        </div>
        <button id="g-btn" onclick="toggleGlobal()">START</button>
    </div>

    <div class="score-box">
        <div class="score-grid" id="scoreGrid"></div>
    </div>

    <div id="q-container"></div>

<script>
    // é¡Œç›®è¨­å®šï¼šç¸½æ™‚é•· 24 åˆ†é˜ï¼Œé ç•™ 6 åˆ†é˜ç·©è¡
    // s: ç§’æ•¸ (æ ¹æ“šé›£åº¦é…é€Ÿ)
    const quests = [
        { t: "1. è‚¥çš‚ (Soap)", s: 200, h: ["ç’°å¢ƒ: å„€å¼ç©ºé–“ä¸­çš„æ¶ˆç£¨","æ–¹å‘: å›ºé«”å‘æ³¡æ²«çš„ç‹€æ…‹è½‰ç§»","æš—å–»: è‡ªæˆ‘æ¶ˆç£¨ä»¥æ›å–ä»–äººæ¸…çˆ½","ç‰©ç†: æ½®æ¿•æ™‚å…·ä¾µç•¥æ€§çš„é€ƒé¿","æ¥µé™: æ°´å¾ªç’°ä¸­çŸ­æš«çš„æ¶ˆè€—å“"] }, // 4 min
        { t: "2. ç™¼ç¥¨ (Receipt)", s: 200, h: ["ç‰©ç†: äº¤æ˜“å¾Œçš„è³‡è¨Šè¼‰é«”","æ–¹å‘: éš¨æ©Ÿä¸”å»¶æ™‚çš„åƒ¹å€¼å…Œæ›","æš—å–»: æ‰¿è¼‰å¤¢æƒ³çš„è–„ç´™èˆ‡åƒåœ¾","ç§©åº: è¨˜è¼‰é‡‘éŒ¢æµå‘èˆ‡æ™‚é–“çš„æ•¸å­—","å“²å­¸: å…©å€‹æœˆä¸€æ¬¡çš„æ©Ÿç‡æ¸¬è©¦"] }, // 4 min
        { t: "3. åƒåœ¾æ¡¶ (Trash)", s: 180, h: ["ç©ºé–“: é—œæ–¼æ¨æ£„çš„å›ºå®šåº§æ¨™","æ–¹å‘: æ”¶ç´è¢«åˆ¤å®šç‚ºç„¡åŠŸèƒ½çš„äº‹ç‰©","æš—å–»: å®‰éœæ”¶ç´éºå¿˜çš„å®ˆå¢“äºº","æ„Ÿå®˜: å¿½è¦–éä¹…æœƒç™¼å‡ºå¼·çƒˆè­¦å‘Š","å“²å­¸: åæ˜ ä½¿ç”¨è€…ç”Ÿæ´»æ®˜é¤˜çš„é¡å­"] }, // 3 min
        { t: "4. å½±å­ (Shadow)", s: 360, h: ["ç‰©ç†: èƒ½é‡æ³¢ä¸‹çš„å¿…ç„¶ç”¢ç‰©","æ–¹å‘: æ“æœ‰è¼ªå»“å»ç„¡ç‰©è³ªé‡é‡","æš—å–»: å…‰ä¸­èµ·èˆï¼Œæš—ä¸­éºæ£„","è¡Œç‚º: æ¨¡ä»¿ä½ å»ç„¡æ³•è¢«ä½ è§¸ç¢°","æ¥µé™: å…‰äº®çš„å¢³å¢“ï¼Œå­˜åœ¨çš„å¦ä¸€é¢"] }, // 6 min (é­”ç‹é¡Œ)
        { t: "5. æŒ‡ç”²å‰ª (Clipper)", s: 180, h: ["è¡Œç‚º: èº«é«”çµ„ç¹”çš„å®šæœŸæ”¶å‰²","æ–¹å‘: å®£å‘Šé˜²ç¦¦æ©Ÿåˆ¶çµ‚çµçš„éŸ³é »","æš—å–»: è™•ç†èº«é«”æº¢å‡ºéƒ¨åˆ†çš„åˆ‘å…·","ç‰©ç†: æ§“æ¡¿è½‰åŒ–ç‚ºç²¾ç¢ºçš„åˆ‡å‰²åŠ›","å“²å­¸: é‡æ¸…èº«é«”èˆ‡å¤–ç•Œçš„é‚Šç•Œ"] }, // 4 min
        { t: "6. éˆ¾ (Uranium)", s: 300, h: ["ç’°å¢ƒ: ç¾ä»£æ–‡æ˜é‹ä½œçš„åº•å±¤å¯†ç¢¼","æ–¹å‘: é€±æœŸè¡¨ä¸­çš„ä¸ç©©å®šæ¬ŠåŠ›ä½ç½®","æš—å–»: ä¸Šå¸éºç•™ä¸‹çš„å±éšªç«ç„°","ç‰©ç†: è¡°è®Šä¸­ç…§äº®æˆ–æ‘§æ¯€æ–‡æ˜","æ–‡åŒ–: è¶…ç´šè‹±é›„èµ·æºèˆ‡æœ«æ—¥çµ‚çµ"] } // 3 min
    ];

    // åˆå§‹åŒ–ç©åˆ†
    const sGrid = document.getElementById('scoreGrid');
    for(let i=1; i<=9; i++){
        sGrid.innerHTML += `
        <div class="p-card">
            <div class="p-info">P${i} <span onclick="modScore(${i},-1)">-</span></div>
            <div class="p-val" id="s${i}">0</div>
            <button class="btn-score" style="background:#444" onclick="modScore(${i},1)">+</button>
        </div>`;
    }
    function modScore(i,v){ 
        let e=document.getElementById('s'+i); 
        let n=parseInt(e.innerText)+v; 
        if(n>=0) e.innerText=n; 
        // åŠ åˆ†æ™‚è®Šè‰²æç¤º
        if(v>0) { e.style.color=varCss('--green'); setTimeout(()=>e.style.color=varCss('--gold'), 300); }
    }
    function varCss(name){ return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }

    // åˆå§‹åŒ–é¡Œç›®
    const qCont = document.getElementById('q-container');
    quests.forEach((q, i) => {
        qCont.innerHTML += `
        <div class="q-card" id="card${i}">
            <div class="q-header">
                <span class="q-title">${q.t}</span>
                <span class="q-timer" id="tm${i}">${fmt(q.s)}</span>
            </div>
            <div class="status-bar"><div class="progress" id="prog${i}"></div></div>
            <button class="btn-ctrl" id="btn${i}" onclick="toggleQuest(${i})">START MISSION</button>
            <button class="hint-btn" id="hb${i}" onclick="toggleHint(${i})">ğŸ” é»æ­¤å±•é–‹æç¤ºåº« (L1-L5)</button>
            <div class="hint-content" id="hc${i}">
                ${q.h.map((t,idx)=>`<div class="h-row"><b>L${idx+1}</b> ${t}</div>`).join('')}
            </div>
        </div>`;
    });

    function fmt(s){ return Math.floor(s/60)+":"+(s%60).toString().padStart(2,'0'); }
    function toggleHint(i){ const e=document.getElementById('hc'+i); e.style.display=e.style.display==='block'?'none':'block'; }

    // å…¨å±€è¨ˆæ™‚
    let gTime = 1800, gInt = null;
    function toggleGlobal(){
        const b = document.getElementById('g-btn');
        if(gInt){ clearInterval(gInt); gInt=null; b.innerText="RESUME"; b.style.background="#f39c12"; }
        else {
            b.innerText="PAUSE"; b.style.background="#c0392b";
            gInt = setInterval(()=>{
                if(gTime>0){
                    gTime--; document.getElementById('g-timer').innerText=fmt(gTime);
                    if(gTime<300) document.getElementById('g-timer').style.color="#ff4757";
                } else { clearInterval(gInt); alert("30åˆ†é˜åˆ°ï¼"); }
            },1000);
        }
    }

    // å–®é¡Œé‚è¼¯
    let qInts = {};
    function toggleQuest(i){
        const card = document.getElementById('card'+i);
        const btn = document.getElementById('btn'+i);
        const hb = document.getElementById('hb'+i);
        const prog = document.getElementById('prog'+i);
        
        // äº’æ–¥é‚è¼¯ï¼šé–‹æ–°é¡Œæ™‚ï¼Œæš«åœå…¶ä»–é¡Œ
        Object.keys(qInts).forEach(k => { if(k!=i && qInts[k]) toggleQuest(k); });

        if(qInts[i]){ // æš«åœ
            clearInterval(qInts[i]); delete qInts[i];
            btn.innerText="RESUME"; card.classList.remove('active');
            hb.className="hint-btn"; // ç§»é™¤é–ƒçˆ
        } else { // é–‹å§‹
            btn.innerText="RUNNING..."; card.classList.add('active');
            let total = quests[i].s;
            let [m,s] = document.getElementById('tm'+i).innerText.split(':').map(Number);
            let rem = m*60+s;

            qInts[i] = setInterval(()=>{
                if(rem>0){
                    rem--;
                    document.getElementById('tm'+i).innerText=fmt(rem);
                    
                    // é€²åº¦æ¢
                    prog.style.width = (rem/total*100) + "%";
                    if(rem/total < 0.3) prog.style.background = "#ff4757";

                    // è‡ªå‹•æç¤ºæé†’é‚è¼¯
                    // å‰©é¤˜ 75% (ç ´å†°) -> é»ƒè‰²é–ƒçˆ
                    if(rem == Math.floor(total*0.75)) { hb.classList.add('alert-green'); vib(200); }
                    // å‰©é¤˜ 50% (åŠ æº«) -> é»ƒè‰²é–ƒçˆ
                    if(rem == Math.floor(total*0.50)) { hb.classList.remove('alert-yellow'); void hb.offsetWidth; hb.classList.add('alert-yellow'); vib(200); }
                    // å‰©é¤˜ 25% (æ€¥è¿«) -> ç´…è‰²é–ƒçˆ
                    if(rem == Math.floor(total*0.25)) { hb.classList.remove('alert-yellow'); hb.classList.add('alert-red'); vib([200,100,200]); }

                } else {
                    clearInterval(qInts[i]);
                    btn.innerText="FINISHED"; btn.style.opacity=0.5;
                    card.classList.remove('active'); hb.className="hint-btn";
                    vib(1000);
                }
            },1000);
        }
    }
    
    function vib(ptrn){ if(navigator.vibrate) navigator.vibrate(ptrn); }
</script>
</body>
</html>